RedactorX.add("plugin","counter",{translations:{en:{counter:{words:"words",chars:"chars"}}},subscribe:{"editor.insert, editor.set, editor.empty":function(){this.count()}},start:function(){this.$editor=this.app.editor.getEditor(),this.$editor.on("keyup."+this.prefix+"-plugin-counter paste."+this.prefix+"-plugin-counter",this.count.bind(this)),this.count()},stop:function(){this.$editor.off("."+this.prefix+"-plugin-counter"),this.app.statusbar.remove("words"),this.app.statusbar.remove("chars")},count:function(){var t,s=0,r=0,e=0,i=this.$editor.html(),a=(""!==(i=this._clean(i))&&(a=i.split(/\s+/),t=i.match(/\s/g),s=a?a.length:0,e=t?t.length:0,r=i.length),{words:s,characters:r,spaces:e});this.app.broadcast("counter",a),this.app.statusbar.add("words",this.lang.get("counter.words")+": "+a.words),this.app.statusbar.add("chars",this.lang.get("counter.chars")+": "+a.characters)},_clean:function(t){return t=(t=(t=(t=(t=(t=(t=t.replace(/<\/(.*?)>/gi," ")).replace(/<(.*?)>/gi,"")).replace(/\t/gi,"")).replace(/\n/gi," ")).replace(/\r/gi," ")).replace(/&nbsp;/g,"1")).trim(),t=this.app.utils.removeInvisibleChars(t)}});